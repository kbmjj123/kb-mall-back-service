# mongodb-backend-nodejs

## å‰è¨€
> ä½œä¸ºå­¦ä¹ mongodbåå°æœåŠ¡ç¼–ç¨‹çš„demoé¡¹ç›®ï¼Œä»0åˆ°1æ­å»ºç›¸åº”çš„ä»£ç ç›®å½•æ¡†æ¶ã€‚
> å¹¶ä»¥æ­¤æ¥æå‡å…³äº`nodejs`å­¦ä¹ çš„ç†Ÿæ‚‰ç¨‹åº¦

## ç›®å½•ç»“æ„è¯´æ˜
```
mongodb-backend-nodejs
â”œâ”€ LICENSE
â”œâ”€ README.md
â”œâ”€ assets
â”‚  â”œâ”€ watchæ¨¡å¼å¯åŠ¨æœåŠ¡.png
â”‚  â”œâ”€ ç›®å½•ç»“æ„.png
â”‚  â””â”€ è®¿é—®ä¸å­˜åœ¨çš„é“¾æ¥å¼‚å¸¸ç»“æœ.png
â”œâ”€ config
â”œâ”€ control
â”œâ”€ index.js
â”œâ”€ middleware
â”‚  â”œâ”€ not-found-middleware.js
â”‚  â””â”€ service-error-middleware.js
â”œâ”€ model
â”‚  â””â”€ userModel.js
â””â”€ package.json
```

## å¯åŠ¨å‘½ä»¤
> ä¸€èˆ¬åœ°ï¼Œæˆ‘ä»¬é‡‡ç”¨`node index.js`çš„æ–¹å¼æ¥å¯åŠ¨ä¸€ä¸ªç¨‹åºï¼ŒğŸ˜£ ä½†æ˜¯ï¼Œåœ¨å®é™…çš„ç¼–ç è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šç»å¸¸æ›´æ”¹ç›¸å…³çš„ç¨‹åºæ–‡ä»¶ï¼Œæ¯æ¬¡éƒ½éœ€è¦å…³æ‰æ—§æœåŠ¡ï¼Œå¹¶é‡æ–°å¼€å¯æ–°çš„æœåŠ¡ï¼Œå› æ­¤ï¼Œå¯ä»¥å€ŸåŠ©äºæ–°çš„ä¸€ä¸ªåº“ï¼š`nodemon`ï¼Œå…³äºè¿™ä¸ªåº“çš„è¯´æ˜ï¼Œè¯¦æƒ…è§ [å®˜ç½‘](https://www.npmjs.com/package/nodemon)ï¼Œé€šè¿‡ä½¿ç”¨è¿™ä¸ª`nodeman`å‘½ä»¤ï¼Œå¯ä»¥å®ç°å…é‡å¯æœåŠ¡å®ç°ä»£ç çš„æ›´æ–°ï¼
```shell
  nodeman index.js
```
è¿™è¾¹åŒæ—¶å°†æ‰§è¡ŒæœåŠ¡çš„å‘½ä»¤ï¼Œç»´æŠ¤åˆ°`package.json`ä¸­çš„`script`èŠ‚ç‚¹ä¸­ï¼Œå¹¶æ‰§è¡Œè¯¦æƒ…çš„å‘½ä»¤ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š
![nodemonæ‰§è¡Œç»“æœ](./assets/è®¿é—®ä¸å­˜åœ¨çš„é“¾æ¥å¼‚å¸¸ç»“æœ.png)

## ä¸‰æ–¹åº“ä¾èµ–è¯´æ˜
> ğŸ‘‡ æ•´ç†äº†å…³äºæœ¬é¡¹ç›®ä¸­åœ¨codingè¿‡ç¨‹ä¸­æ‰€ä½¿ç”¨çš„ä¸‰æ–¹ä¾èµ–åº“è¯´æ˜æ¸…å•ï¼š

| ä¾èµ–åç§° | æè¿° | ç›¸å…³åœ°å€ |
|---|---|---|
| express | nodesjè½»é‡çº§æœåŠ¡åº“ | ![å®˜æ–¹åœ°å€](https://expressjs.com/) |
| mongoose | mongodbçš„ogm | ![å®˜æ–¹åœ°å€](https://mongoosejs.com/) |
| bcrypt | åŠ å¯†åº“ï¼Œç”¨äºåŠ å¯†ä»¥åŠå¯†ç æ ¡éªŒç”¨é€” | ![åº“åœ°å€](https://www.npmjs.com/package/bcrypt) |
| jsonwebtoken | ç”¨äºtokençš„æ ¡éªŒå’Œå¤„ç†å·¥ä½œ | ![åº“åœ°å€](https://www.npmjs.com/package/jsonwebtoken) |
|  |  |  |
|  |  |  |

## expresså®˜æ–¹çš„ä¸­é—´ä»¶ä»¥åŠè‡ªå®šä¹‰ä¸­é—´ä»¶
> ä½¿ç”¨`express`æ¥å¼€å‘çš„è¯ï¼Œä¸€èˆ¬ä¼šé…å¥—ä½¿ç”¨å®˜æ–¹æ‰€æä¾›çš„ä¸­é—´ä»¶ï¼Œ ğŸ‘‡ æ˜¯å¯¹åº”çš„å®˜æ–¹ä¸­é—´ä»¶è¯´æ˜æ¸…å•ï¼š

| ä¸­é—´ä»¶åç§° | æè¿° |
|---|:---|
|  |  |
|  |  |
|  |  |
|  |  |
|  |  |

### æœ¬åœ°è‡ªå®šä¹‰ä¸­é—´ä»¶
> å› å®é™…ä¸šåŠ¡å¼€å‘éœ€è¦ï¼Œé’ˆå¯¹ä¸šåŠ¡è¿›è¡Œç›¸åº”çš„æœ¬åœ°åŒ–ä¸­é—´ä»¶å¼€å‘ï¼Œä»¥ä¾¿äºæ»¡è¶³é¡¹ç›®çš„å˜åŠ¨å‘å±•è¯‰æ±‚ï¼Œ ğŸ‘‡ æ˜¯å¯¹åº”çš„è‡ªå®šä¹‰æœ¬åœ°ä¸­é—´ä»¶è¯´æ˜æ¸…å•ï¼š

| ä¸­é—´ä»¶åç§° | æè¿° |
|---|:---|
| not-found-middleware | æ‰¾ä¸åˆ°æœåŠ¡ï¼Œä¹Ÿå°±æ˜¯404 |
| service-error-middleware | ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†ä¸­é—´ä»¶ |
|  |  |
|  |  |
|  |  |


## é¡¹ç›®è¿‡ç¨‹è®°å½•
> æ­¤ç›®å½•ä»¥åŠåç»­çš„å†…å®¹ï¼Œå°†è®°å½•æ•´ä¸ªé¡¹ç›®è¿‡ç¨‹ä¸­çš„ç¬”è®°ï¼Œä¾¿äºåç»­è·Ÿè¸ªä¸åæŸ¥é—®é¢˜ï¼ï¼

### æ ¹æ®æ ‡å‡†çš„MVCç†å¿µï¼Œåˆ›å»ºå¥½å¯¹åº”çš„æ–‡ä»¶èµ„æºç›®å½•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
  ![æ–‡ä»¶èµ„æºç›®å½•](./assets/ç›®å½•ç»“æ„.png)

### åˆ›å»ºå®Œæˆ404ä»¥åŠå…¬å…±çš„å¼‚å¸¸å¤„ç†ä¸­é—´ä»¶(å…·ä½“è§ä¸¤ä¸­é—´ä»¶çš„ä»£ç å†…å®¹)ï¼Œå¹¶åšå¯¹åº”çš„æµ‹è¯•éªŒè¯ï¼š
```javascript
app.get('/login', (req, res, next) => {
  const error = new Error('è‡ªå®šä¹‰å¼‚å¸¸ä¿¡æ¯')
  throw error;
})
```
![404å¼‚å¸¸](./assets/è®¿é—®ä¸å­˜åœ¨çš„é“¾æ¥å¼‚å¸¸ç»“æœ.png)

### æ ¹æ®ä¸šåŠ¡å®é™…åœºæ™¯ï¼Œå°†é¡¹ç›®æ‹†åˆ†ä¸ºä¸åŒçš„æ¨¡å—ï¼ŒåŒæ—¶å¯¹åº”äºä¸åŒçš„è·¯ç”±æ¨¡å—ï¼ŒåŒæ—¶å€Ÿé‰´äºå‰ç«¯æ¨¡å—åŒ–å¼€å‘çš„æ–¹å¼ï¼Œå°†æ‰€æœ‰çš„è·¯ç”±æ¨¡å—é‡‡ç”¨å¯¹å¤–ä»…æš´éœ²ä¸€ä¸ªå…¥å£çš„æ–¹å¼ 
```javascript
  const userRouter = require('./userRouter')
  // è¿™é‡Œé‡‡ç”¨å¯¹å¤–æš´éœ²ä¸€ä¸ªæ¥æ”¶appåº”ç”¨ç¨‹åºå…¥å£çš„æ–¹å¼ï¼Œæ¥å¯¹å¤–éšè—æ³¨å†Œçš„æ–¹å¼
  module.exports = app => {
    app.use('/user', userRouter);
  }
```
